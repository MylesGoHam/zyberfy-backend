{% extends "base.html" %}

{% block title %}Analytics{% endblock %}

{% block content %}
  <div class="container mx-auto mt-8">
    <div class="flex justify-between items-center mb-4">
      <h1 class="text-2xl font-bold">Analytics Overview</h1>
      <a href="{{ url_for('dashboard') }}" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">‚Üê Back to Dashboard</a>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="p-4 bg-white shadow rounded">
        <h2 class="text-lg font-semibold">Pageviews</h2>
        <p class="text-3xl">{{ pageviews }}</p>
      </div>
      <div class="p-4 bg-white shadow rounded">
        <h2 class="text-lg font-semibold">Saves</h2>
        <p class="text-3xl">{{ saves }}</p>
      </div>
      <div class="p-4 bg-white shadow rounded">
        <h2 class="text-lg font-semibold">Proposals Sent</h2>
        <p class="text-3xl">{{ conversions }}</p>
      </div>
    </div>

    <!-- Donut chart -->
    <div class="mb-8">
      <canvas id="donutChart"></canvas>
    </div>

    <!-- Line chart -->
    <div>
      <canvas id="lineChart"></canvas>
    </div>
  </div>

  <script>
    // Donut
    new Chart(document.getElementById('donutChart'), {
      type: 'doughnut',
      data: {
        labels: ['Converted', 'Dropped'],
        datasets: [{ data: [{{ donut_converted }}, {{ donut_dropped }}] }]
      }
    });

    // Line
    new Chart(document.getElementById('lineChart'), {
      type: 'line',
      data: {
        labels: {{ line_labels|tojson }},
        datasets: [{
          label: 'Pageviews',
          data: {{ line_data|tojson }},
          fill: false,
          tension: 0.1
        }]
      }
    });
  </script>
{% endblock %}
